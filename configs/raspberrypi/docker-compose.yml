networks:
  homelab:
    driver: bridge

volumes:
  portainer_data:
  grafana_data:
  uptimekuma_data:

services:

  # ---- 1) Portainer CE ----
  portainer:
    image: portainer/portainer-ce:latest
    restart: unless-stopped
    ports:
      - "9443:9443"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - portainer_data:/data
    networks: [homelab]

  # ---- 2) Paperless-ngx ----
  paperless:
    image: ghcr.io/paperless-ngx/paperless-ngx:latest
    container_name: paperless
    restart: unless-stopped
    depends_on:
      - paperless-redis
    ports:
      - "8000:8000"              # http://<pi-ip>:8000
    environment:
      PAPERLESS_REDIS: redis://paperless-redis:6379
      PAPERLESS_SECRET_KEY: "CHANGE_ME_TO_A_LONG_RANDOM_STRING"
      PAPERLESS_TIME_ZONE: "America/New_York"
      PAPERLESS_OCR_LANGUAGE: "eng"
      # Links in emails, etc.
      PAPERLESS_URL: "http://raspi5:8000"
    volumes:
      # SQLite DB + internal data
      - ./paperless/data:/usr/src/paperless/data
      # Stored documents
      - ./paperless/media:/usr/src/paperless/media
      # Exported backups
      - ./paperless/export:/usr/src/paperless/export
      # "Inbox" â€“ drop PDFs to auto-import
      - ./paperless/consume:/usr/src/paperless/consume

  # Redis for Paperless-ngx
  paperless-redis:
    image: redis:7-alpine
    container_name: raspberrypi-paperless-redis-1
    restart: unless-stopped
    command: ["redis-server", "--save", "60", "1", "--loglevel", "warning"]
    volumes:
      - ./paperless/redis-data:/data

  # ---- 3) Dashy - Touchscreen Home ----
  dashy:
    image: lissy93/dashy:latest
    container_name: raspberrypi-dashy-1
    restart: unless-stopped
    ports:
      - "4000:8080"                # http://<pi-ip>:8080
    environment:
      - NODE_ENV=production

  # ---- 4) Glances - Pi/System Monitor ----
  glances:
    image: nicolargo/glances:latest
    container_name: raspberrypi-glances-1
    restart: unless-stopped
    network_mode: host          # port 61208 of the Pi
    pid: host
    environment:
      - GLANCES_OPT=--webserver
    volumes:
      # Lets Glances show Docker info
      - /var/run/docker.sock:/var/run/docker.sock:ro

  # ---- 5) Uptime-Kuma ----
  uptime-kuma:
    image: louislam/uptime-kuma:latest
    restart: unless-stopped
    ports:
      - "3001:3001"
    volumes:
      - uptimekuma_data:/app/data
    networks: [homelab]


   # ---- 6) Camera-Stream ----

  mediamtx:
    image: bluenviron/mediamtx:latest-ffmpeg
    devices:
      - /dev/video0:/dev/video0
    ports:
      - "8554:8554" # RTSP
    volumes:
      - '/opt/homelab/mediamtx.yml:/mediamtx.yml:ro'
    restart: unless-stopped
    networks: [homelab]


